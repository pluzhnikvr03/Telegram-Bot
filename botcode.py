import telebot
import config
from telebot import types
import random # –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ random –¥–ª—è —Ä–∞–Ω–¥–æ–º–Ω–æ–≥–æ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–∞
from PIL import Image # –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PIL –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ç–æ
import io # "–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞" –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, –≥–¥–µ –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ(—Ñ–æ—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤


API_TOKEN = config.token
bot = telebot.TeleBot(API_TOKEN)


# –•—Ä–∞–Ω–∏–ª–∏—â–∞
favorites = {} # –°–ª–æ–≤–∞—Ä—å —Å –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è —é–∑–µ—Ä–∞
user_compliments = {} # –¢–µ–∫—É—â–∏–π –∏–∑–±—Ä–∞–Ω–Ω—ã–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç
user_waiting_for_photo = {} # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∂–∏–º–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å /photo –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Ñ–æ—Ç–æ
users = {} # –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_states = {} # –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ –≤—Ä–µ–º—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏


# –°–ø–∏—Å–∫–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
intelligence = ["–í–æ—Å—Ö–∏—â–∞—é—Å—å —Ç–≤–æ–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö.", 
"–¢–≤–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–ª–∞–¥ —É–º–∞ –≤—Å–µ–≥–¥–∞ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç –º–µ–Ω—è.",
"–° —Ç–æ–±–æ–π –ª—é–±–æ–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –∏ –≥–ª—É–±–æ–∫–∏–º.",
"–° —Ç–æ–±–æ–π –º–æ–∂–Ω–æ –º–æ–ª—á–∞—Ç—å –∏ –≤–º–µ—Å—Ç–µ –¥—É–º–∞—Ç—å ‚Äî –∏ —ç—Ç–æ –±—É–¥–µ—Ç —Ç–∞–∫–∏–º –∂–µ –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–º –æ–±—â–µ–Ω–∏–µ–º, –∫–∞–∫ –∏ –¥–æ–ª–≥–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä.",
"–¢—ã –≤—Å–µ–≥–¥–∞ –≤ –∫—É—Ä—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π.",
"–ì–ª—É–±–∏–Ω–∞ —Ç–≤–æ–∏—Ö –º—ã—Å–ª–µ–π –ø–æ—Ä–∞–∂–∞–µ—Ç –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç.",
"–¢–≤–æ—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É—á–∏—Ç—å—Å—è –Ω–æ–≤–æ–º—É –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫—Ä–µ–Ω–Ω–µ–µ —É–≤–∞–∂–µ–Ω–∏–µ.",
"–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Ç–µ–±–µ –≤–æ –≤—Å—ë–º.",
"–¢—ã –Ω–µ –±–æ–∏—à—å—Å—è –º–µ–Ω—è—Ç—å —Å–≤–æ–µ –º–Ω–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—à—å –Ω–æ–≤—ã–µ —Ñ–∞–∫—Ç—ã, –∏ —ç—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –≥–∏–±–∫–æ—Å—Ç–∏ –∏ —Å–∏–ª–µ —Ç–≤–æ–µ–≥–æ —É–º–∞.",
"–¢–≤–æ–π —Ä–∞–∑—É–º ‚Äî –Ω–∞—Å—Ç–æ—è—â–µ–µ —Å–æ–∫—Ä–æ–≤–∏—â–µ."]

appearance = ["–¢–≤–æ—è —É–ª—ã–±–∫–∞ –æ—Å–≤–µ—â–∞–µ—Ç –≤—Å—ë –≤–æ–∫—Ä—É–≥.",
"–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∞ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º–æ–π.",
"–ò–∑—è—â–µ—Å—Ç–≤–æ –≤ –∫–∞–∂–¥–æ–º —Ç–≤–æ—ë–º –¥–≤–∏–∂–µ–Ω–∏–∏.",
"–¢–≤–æ–π —Å—Ç–∏–ª—å –≤—Å–µ–≥–¥–∞ –±–µ–∑—É–ø—Ä–µ—á–µ–Ω.",
"–¢–≤–æ–∏ –≥–ª–∞–∑–∞ –∏–∑–ª—É—á–∞—é—Ç –æ—Å–æ–±–æ–µ —Å–∏—è–Ω–∏–µ.",
"–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –µ—â—ë –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–µ–µ.",
"–ì—Ä–∞—Ü–∏—è –≤ –∫–∞–∂–¥–æ–º —Ç–≤–æ—ë–º –∂–µ—Å—Ç–µ.",
"–¢–≤–æ—è –≤–Ω–µ—à–Ω–æ—Å—Ç—å –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –≥–∞—Ä–º–æ–Ω–∏—é.",
"–¢–≤–æ—ë –ø—Ä–∏—Ä–æ–¥–Ω–æ–µ –æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç –≤–∑–≥–ª—è–¥—ã.",
"–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å ‚Äî —Ç–≤–æ—è –≤—Ç–æ—Ä–∞—è –Ω–∞—Ç—É—Ä–∞."]

character = ["–î–æ–±—Ä–æ—Ç–∞ —Ç–≤–æ–µ–≥–æ —Å–µ—Ä–¥—Ü–∞ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –æ–∫—Ä—É–∂–∞—é—â–∏—Ö.",
"–°–∏–ª–∞ –¥—É—Ö–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å –ª—é–±—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏.",
"–ß–µ—Å—Ç–Ω–æ—Å—Ç—å –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –Ω–∞–¥—ë–∂–Ω—ã–º –¥—Ä—É–≥–æ–º.",
"–û—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å ‚Äî —Ä–µ–¥–∫–æ–µ –∏ —Ü–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ.",
"–¶–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω–æ—Å—Ç—å –ø–æ–º–æ–≥–∞–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å –≤—ã—Å–æ—Ç.",
"–£–º–µ–Ω–∏–µ –ø—Ä–æ—â–∞—Ç—å –≥–æ–≤–æ—Ä–∏—Ç –æ –±–æ–ª—å—à–æ–π –¥—É—à–µ.",
"–°—Ç–æ–π–∫–æ—Å—Ç—å —Ç–≤–æ–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ.",
"–ò—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–º –ø–æ—Å—Ç—É–ø–∫–µ.",
"–£–º–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É –±–µ—Å—Ü–µ–Ω–Ω–æ.",
"–í–µ–ª–∏–∫–æ–¥—É—à–∏–µ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ–π."]

sense_of_humor = ["–¢—ã —É–º–µ–µ—à—å —Ä–∞–∑—Ä—è–¥–∏—Ç—å –æ–±—Å—Ç–∞–Ω–æ–≤–∫—É –æ–¥–Ω–æ–π-–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ—Ä–∞–∑–æ–π, –∫–æ–≥–¥–∞ –≤—Å–µ –≤–æ–∫—Ä—É–≥ –Ω–∞ –≤–∑–≤–æ–¥–µ. –≠—Ç–æ –±–µ—Å—Ü–µ–Ω–Ω—ã–π —Ç–∞–ª–∞–Ω—Ç.",
"–¢–≤–æ–π —é–º–æ—Ä ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä —à—É—Ç–æ–∫, –∞ —Ü–µ–ª–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ –≤–∏–¥–µ—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–µ –∏ —Å–º–µ—à–Ω–æ–µ –≤ –æ–±—ã–¥–µ–Ω–Ω–æ–º.",
"–¢–≤–æ–∏ —à—É—Ç–∫–∏ –≤—Å–µ–≥–¥–∞ —Ç–∞–∫–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –≤—ã–∑—ã–≤–∞—é—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —É–ª—ã–±–∫—É, –∞ –Ω–∞—Å—Ç–æ—è—â–∏–π –≤–∑—Ä—ã–≤ —Å–º–µ—Ö–∞.",
"–° —Ç–æ–±–æ–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–∫—É—á–∞—Ç—å. –¢—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ—à—å –ª—é–±—É—é, –¥–∞–∂–µ —Å–∞–º—É—é —Ä—É—Ç–∏–Ω–Ω—É—é —Å–∏—Ç—É–∞—Ü–∏—é, –≤ –≤–µ—Å–µ–ª–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ.",
"–£ —Ç–µ–±—è –æ—á–µ–Ω—å –∑–∞—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–π —Å–º–µ—Ö. –ö–æ–≥–¥–∞ —Ç—ã —Å–º–µ—ë—à—å—Å—è, —Ö–æ—á–µ—Ç—Å—è —Å–º–µ—è—Ç—å—Å—è –≤–º–µ—Å—Ç–µ —Å —Ç–æ–±–æ–π, –¥–∞–∂–µ –Ω–µ –∑–Ω–∞—è –ø—Ä–∏—á–∏–Ω—ã.",
"–¢–≤–æ–π —é–º–æ—Ä ‚Äî —ç—Ç–æ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Ç–≤–æ–µ–≥–æ —Å–≤–µ—Ç–ª–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –Ω–∞ –º–∏—Ä. –ü–æ—Å–ª–µ –æ–±—â–µ–Ω–∏—è —Å —Ç–æ–±–æ–π –æ—Å—Ç–∞—ë—Ç—Å—è –æ—â—É—â–µ–Ω–∏–µ –ª—ë–≥–∫–æ—Å—Ç–∏ –∏ —Ä–∞–¥–æ—Å—Ç–∏.",
"–¢—ã –∫–∞–∫ –∂–∏–≤–æ–π –∞–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç. –û–¥–Ω–∞ —Ç–≤–æ—è —à—É—Ç–∫–∞ –º–æ–∂–µ—Ç –≤—ã—Ç–∞—â–∏—Ç—å –º–µ–Ω—è –∏–∑ –ø–ª–æ—Ö–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è.",
"–¢—ã –Ω–µ —à—É—Ç–∏—à—å, –∞ —Å–æ–∑–¥–∞–µ—à—å —Ü–µ–ª—ã–µ –∫–æ–º–µ–¥–∏–π–Ω—ã–µ –≤—Å–µ–ª–µ–Ω–Ω—ã–µ –∏–∑ –æ–±—ã—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π. –≠—Ç–æ —Ç–∞–ª–∞–Ω—Ç!",
"–° —Ç–æ–±–æ–π –¥–∞–∂–µ –≤ –æ—á–µ—Ä–µ–¥–∏ –∑–∞ —Ö–ª–µ–±–æ–º –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –Ω–∞ —Å—Ç–µ–Ω–¥–∞–ø-–∫–æ–Ω—Ü–µ—Ä—Ç. –¢—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ—à—å —Ä—É—Ç–∏–Ω—É –≤ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ.",
"–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞ –¥–µ–ª–∞–µ—Ç –∂–∏–∑–Ω—å —è—Ä—á–µ."]


# –°–ª–æ–≤–∞—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–ø–∏—Å–∫–∞–º
compliment_categories = {"–£–º": intelligence, "–í–Ω–µ—à–Ω–æ—Å—Ç—å": appearance, "–•–∞—Ä–∞–∫—Ç–µ—Ä": character, "–ß—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞": sense_of_humor}


# Handle '/start'
@bot.message_handler(commands=['start'])
def send_welcome(message):
    remove_keyboard = types.ReplyKeyboardRemove() # –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    bot.reply_to(message, """\
–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞–µ—Ç, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Ç–µ–ø–ª–µ–µ –∏ –ø—Ä–∏—è—Ç–Ω–µ–µ. 
–ù–∞–∂–º–∏—Ç–µ /help, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –æ –º–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö. \
""", reply_markup=remove_keyboard)


# Handle '/help'
@bot.message_handler(commands=['help'])
def send_help(message):
    remove_keyboard = types.ReplyKeyboardRemove() # –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    bot.reply_to(message, """\
–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
/start - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º; 
/help - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞; 
/compliment - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç;
/photo -  —Å–¥–µ–ª–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á—ë—Ä–Ω–æ-–±–µ–ª—ã–º;
/sign - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–ª–∏ –≤–æ–π—Ç–∏;
/favorites - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã. \
""", reply_markup=remove_keyboard)


# Handle '/compliment'
@bot.message_handler(commands=['compliment'])
def send_compliment(message):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True)
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏–∑ –∫–ª—é—á–µ–π —Å–ª–æ–≤–∞—Ä—è
    buttons = [types.KeyboardButton(text=i) for i in compliment_categories.keys()]
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ –¥–≤–µ –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥
    keyboard.add(buttons[0], buttons[1])
    keyboard.add(buttons[2], buttons[3])
    bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–∞:", reply_markup=keyboard) # –ü–æ—è–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã



@bot.message_handler(func=lambda message: message.text in compliment_categories) # –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ–∫—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
def handle_compliment_buttons(message):
    # –ü–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    compliment = random.choice(compliment_categories[message.text]) # C–ª—É—á–∞–π–Ω—ã–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    user_compliments[message.from_user.id] = compliment # C–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ª–æ–≤–∞—Ä—å 
    
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ" 
    keyboard = types.InlineKeyboardMarkup()
    fav_button = types.InlineKeyboardButton("‚≠ê –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ", callback_data="add_to_favorites") # –ß—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∞ —á—Ç–æ –±–æ—Ç
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ" –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    show_fav_button = types.InlineKeyboardButton("ü§© –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ", callback_data="show_favorites") # –ß—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∞ —á—Ç–æ –±–æ—Ç
    keyboard.add(fav_button)
    keyboard.add(show_fav_button)
    bot.send_message(message.chat.id, compliment, reply_markup=keyboard) # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É, –∞ —á–µ—Ä–µ–∑ Inline-–∫–Ω–æ–ø–∫—É
@bot.callback_query_handler(func=lambda call: call.data == "add_to_favorites") # –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —Å callback_data="add_to_favorites"
def add_to_favorites(call):
    user_id = call.from_user.id # –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É
    compliment = user_compliments.get(user_id) # –î–æ—Å—Ç–∞–µ–º –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ —Ä–∞–Ω–µ–µ
    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–ª—è —é–∑–µ—Ä–∞, –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
    if user_id not in favorites:
        favorites[user_id] = []
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
    if compliment not in favorites[user_id]:
        favorites[user_id].append(compliment)
        bot.answer_callback_query(call.id, "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ!") # –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
    else:
        bot.answer_callback_query(call.id, "‚ùå –£–∂–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º!") # –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç —É–∂–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ


# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É, –∞ —á–µ—Ä–µ–∑ Inline-–∫–Ω–æ–ø–∫—É
@bot.callback_query_handler(func=lambda call: call.data == "show_favorites") # –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —Å callback_data="show_favorites"
def show_favorites_handler(call): # –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ"
    user_id = call.from_user.id # –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É
    remove_keyboard = types.ReplyKeyboardRemove()
    if user_id in favorites and favorites[user_id]: # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö
        fav_list = ''
        for i in favorites[user_id]:
            fav_list += f'‚Ä¢ {i}\n\n' 
        bot.send_message(call.message.chat.id, f"‚≠ê –í–∞—à–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã:\n\n {fav_list}", reply_markup=remove_keyboard)# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
    else:
        bot.send_message(call.message.chat.id, "üòî –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤", reply_markup=remove_keyboard) # –ï—Å–ª–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –Ω–µ—Ç


# Handle '/favorites'
@bot.message_handler(commands=['favorites'])
def send_favorites(message):
    user_id = message.from_user.id # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ
    if user_id in favorites and favorites[user_id]: # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã
        remove_keyboard = types.ReplyKeyboardRemove() # –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        # –°—Ñ–æ—Ä–º–∏—Ä–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤
        fav_list = ''
        for i in favorites[user_id]:
            fav_list += f'‚Ä¢ {i}\n\n' 
        bot.reply_to(message, f"‚≠ê–í–∞—à–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã:\n\n {fav_list}", reply_markup=remove_keyboard) # –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤ –∏ —É–±–∏—Ä–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
    else:
        remove_keyboard = types.ReplyKeyboardRemove() # –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        bot.reply_to(message, "üòî –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤.", reply_markup=remove_keyboard) # –ü–∏—à–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–≤


# Handle '/photo'
@bot.message_handler(commands=['photo'])
def start_image_exchange(message):
    user_id = message.from_user.id
    remove_keyboard = types.ReplyKeyboardRemove() # –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    # –ü–æ–º–µ—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ –æ–∂–∏–¥–∞—é—â–µ–≥–æ —Ñ–æ—Ç–æ
    user_waiting_for_photo[user_id] = True
    bot.reply_to(message, "–ñ–¥—É –≤–∞—à—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é!", reply_markup=remove_keyboard) # –ü–∏—à–µ–º –æ–± –æ–∂–∏–¥–∞–Ω–∏–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ —É–±–∏—Ä–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
@bot.message_handler(content_types=['photo'])
def photo_processing(message):
    user_id = message.from_user.id # –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ, –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–≤ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –∫–æ–º–º–∞–Ω–¥—É, —Ç–æ –ø—Ä–æ—Å–∏–º –µ–≥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–∞–Ω–¥—É /photo
    if user_id not in user_waiting_for_photo or not user_waiting_for_photo[user_id]:
        bot.reply_to(message, "ü§® –°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /photo")
        return
    user_waiting_for_photo[user_id] = False # –£–±–∏—Ä–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞ –æ–∂–∏–¥–∞–Ω–∏—è
    # –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ç–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    bot.send_chat_action(message.chat.id, 'upload_photo') # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –±–æ—Ç "–ø–µ—á–∞—Ç–∞–µ—Ç"(—Ç.–µ. –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ)
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–æ—Ç–æ
    file_info = bot.get_file(message.photo[-1].file_id) # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ (—Ä–∞–∑–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞). –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç, —ç—Ç–æ —Å–∞–º–∞—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ñ–æ—Ç–æ –∏ –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ñ–∞–π–ª
    downloaded_file = bot.download_file(file_info.file_path) # –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–æ—Ç–æ —Å —Å–µ—Ä–≤–µ—Ä–æ–≤ Telegram –≤ –≤–∏–¥–µ –±–∞–π—Ç–æ–≤ 
    # –û—Ç–∫—Ä—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    image = Image.open(io.BytesIO(downloaded_file)) # –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –±–∞–π—Ç—ã –≤ "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª" –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —ç—Ç–æ—Ç "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª" –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ —á–µ—Ä–Ω–æ-–±–µ–ª–æ–µ
    bw_image = image.convert('L') # convert('L') - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ü–≤–µ—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±—É—Ñ–µ—Ä
    img_byte_arr = io.BytesIO()
    bw_image.save(img_byte_arr, format='JPEG') # C–æ–∑–¥–∞–µ–º "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É" –≤ –ø–∞–º—è—Ç–∏, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —á–µ—Ä–Ω–æ-–±–µ–ª–æ–µ —Ñ–æ—Ç–æ –≤ —ç—Ç—É "–ø–∞–ø–∫—É", –ø–µ—Ä–µ–º–µ—â–∞–µ–º "–∫—É—Ä—Å–æ—Ä" –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ 
    img_byte_arr.seek(0) # –ö–æ–º–∞–Ω–¥–∞ "–ø–µ—Ä–µ–º–æ—Ç–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ"
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ —Ñ–æ—Ç–æ
    bot.send_photo(message.chat.id, img_byte_arr, caption="üì∑ –í–∞—à–µ —Ñ–æ—Ç–æ –≤ —á–µ—Ä–Ω–æ-–±–µ–ª–æ–º —Å—Ç–∏–ª–µ!") # img_byte_arr - "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏", –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –±–∞–π—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.


# Handle '/sign'
@bot.message_handler(commands=['sign'])
def sign_menu(message):
    user_id = message.from_user.id # –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    keyboard = types.InlineKeyboardMarkup() # –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
    if user_id in users: 
        button_login = types.InlineKeyboardButton("üîê –í–æ–π—Ç–∏", callback_data="login") # –ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏"
        keyboard.add(button_login) # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        bot.send_message(message.chat.id, 
                        "–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç! –•–æ—Ç–∏—Ç–µ –≤–æ–π—Ç–∏?",
                        reply_markup=keyboard)
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
    else: 
        button_register = types.InlineKeyboardButton("üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è", callback_data="register") # –ö–Ω–æ–ø–∫–∞ "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è"
        button_login = types.InlineKeyboardButton("üîê –í–æ–π—Ç–∏", callback_data="login") # –ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏"
        keyboard.add(button_register, button_login) # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        bot.send_message(message.chat.id,
                        "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
                        reply_markup=keyboard)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞
@bot.callback_query_handler(func=lambda call: call.data in ["register", "login"])
def handle_sign_buttons(call):
    user_id = call.from_user.id # –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è
    if call.data == "register":
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ–Ω —É–∂–µ
        if user_id in users:
            bot.answer_callback_query(call.id, "–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!") # –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
            return
        # –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        user_states[user_id] = {
            'state': 'waiting_last_name', # –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞(–æ–∂–∏–¥–∞–Ω–∏–µ —Ñ–∞–º–∏–ª–∏–∏)
            'temp_data': {} # –ß–µ—Ä–Ω–æ–≤–∏–∫ –∞–Ω–∫–µ—Ç—ã, –∫—É–¥–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–∫–∞ –æ–Ω –Ω–µ –∑–∞–ø–æ–ª–Ω–∏—Ç –≤—Å—ë
        }
        bot.answer_callback_query(call.id) # –°–æ–æ–±—â–µ–Ω–∏–µ Telegram –æ —Ç–æ–º, —á—Ç–æ –±–æ—Ç –ø–æ–ª—É—á–∏–ª –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –∏ –≤—Å—ë –æ–±—Ä–∞–±–æ—Ç–∞–ª
        bot.send_message(call.message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é:") # –ü—Ä–æ—Å—å–±–∞ –≤–≤–µ—Å—Ç–∏ —Ñ–∞–º–∏–ª–∏—é
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç    
    elif call.data == "login":
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
        if user_id not in users:
            bot.answer_callback_query(call.id, "–°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å!")
            return
        user_states[user_id] = {'state': 'waiting_username_login'} # –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞(–æ–∂–∏–¥–∞–Ω–∏–µ "–∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
        bot.answer_callback_query(call.id) # –°–æ–æ–±—â–µ–Ω–∏–µ Telegram –æ —Ç–æ–º, —á—Ç–æ –±–æ—Ç –ø–æ–ª—É—á–∏–ª –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –∏ –≤—Å—ë –æ–±—Ä–∞–±–æ—Ç–∞–ª
        bot.send_message(call.message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:") # –ü—Ä–æ—Å—å–±–∞ –≤–≤–µ—Å—Ç–∏ "–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"


# –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ—à–∞–≥–æ–≤—ã–π)
@bot.message_handler(func=lambda message: message.from_user.id in user_states) # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
def handle_registration_steps(message):
    # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è(ID –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –Ω–∞ –∫–∞–∫–æ–º —à–∞–≥–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
    user_id = message.from_user.id
    state_info = user_states[user_id]
    # –§–∞–º–∏–ª–∏—è-–∏–º—è
    if state_info['state'] == 'waiting_last_name': # –ï—Å–ª–∏ –±–æ—Ç –∂–¥—ë—Ç —Ñ–∞–º–∏–ª–∏—é
        state_info['temp_data']['last_name'] = message.text # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–º–∏–ª–∏—é
        state_info['state'] = 'waiting_first_name' # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:")
    # –ò–º—è-–æ—Ç—á–µ—Å—Ç–≤–æ
    elif state_info['state'] == 'waiting_first_name': # –ï—Å–ª–∏ –±–æ—Ç –∂–¥—ë—Ç –∏–º—è
        state_info['temp_data']['first_name'] = message.text # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è
        state_info['state'] = 'waiting_patronymic' # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –æ—Ç—á–µ—Å—Ç–≤–æ:")
    #–û—Ç—á–µ—Å—Ç–≤–æ-–≤–æ–∑—Ä–∞—Å—Ç
    elif state_info['state'] == 'waiting_patronymic': # –ï—Å–ª–∏ –±–æ—Ç –∂–¥—ë—Ç –æ—Ç—á–µ—Å—Ç–≤–æ
        state_info['temp_data']['patronymic'] = message.text # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á–µ—Å—Ç–≤–æ
        state_info['state'] = 'waiting_age' # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç:")
    #–í–æ–∑—Ä–∞—Å—Ç-–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è    
    elif state_info['state'] == 'waiting_age': # –ï—Å–ª–∏ –±–æ—Ç –∂–¥—ë—Ç –≤–æ–∑—Ä–∞—Å—Ç
        if not message.text.isdigit():
            bot.send_message(message.chat.id, "‚ùå –í–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞:")
            return
        state_info['temp_data']['age'] = message.text # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç
        state_info['state'] = 'waiting_username' # –ú–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        bot.send_message(message.chat.id, "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–¥–Ω–æ —Å–ª–æ–≤–æ, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤):")
    # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è   
    elif state_info['state'] == 'waiting_username': # –ï—Å–ª–∏ –±–æ—Ç –∂–¥—ë—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø—Ä–æ–±–µ–ª—ã –≤ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if ' ' in message.text: 
            bot.send_message(message.chat.id, "‚ùå –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞:")
            return
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–Ω—è—Ç–æ –ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        username_taken = any(user_data.get('username') == message.text for user_data in users.values())
        if username_taken:
            bot.send_message(message.chat.id, "‚ùå –≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ! –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–µ:")
            return
        state_info['temp_data']['username'] = message.text # –ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã - —Å–æ—Ö—Ä–∞–Ω—è–µ–º
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
        users[user_id] = state_info['temp_data'] # –ü–µ—Ä–µ–Ω–æ—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ
        del user_states[user_id] # –£–±–∏—Ä–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        # –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        user_data = users[user_id]
        summary = f"""‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!

üìã –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
‚Ä¢ –§–∞–º–∏–ª–∏—è: {user_data['last_name']}
‚Ä¢ –ò–º—è: {user_data['first_name']}
‚Ä¢ –û—Ç—á–µ—Å—Ç–≤–æ: {user_data['patronymic']}
‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç: {user_data['age']}
‚Ä¢ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_data['username']}

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç–∞! """
        bot.send_message(message.chat.id, summary)
    elif state_info['state'] == 'waiting_username_login':
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –≤–≤–µ–¥–µ–Ω–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if users[user_id].get('username') == message.text:
            del user_states[user_id] # –£–±–∏—Ä–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—Ö–æ–¥–∞
            user_data = users[user_id]
            bot.send_message(message.chat.id,
                           f"üîì –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!\n\n" # –ì–æ–≤–æ—Ä–∏–º –æ–± —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–∞
                           f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {user_data['last_name']} {user_data['first_name']} {user_data['patronymic']}!")
        else:
            bot.send_message(message.chat.id, "‚ùå –ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞:")


bot.infinity_polling()